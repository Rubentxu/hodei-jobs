{
  "info": {
    "_postman_id": "hodei-jobs-platform-api",
    "name": "Hodei Jobs Platform API",
    "description": "Complete collection for Hodei Jobs Platform gRPC API\n\n## âš ï¸ IMPORTANT - gRPC Limitation\n\nPostman does **NOT** natively support gRPC requests. This collection contains:\n1. **HTTP-based example requests** (for documentation/reference)\n2. **Request templates** you can copy to gRPC tools\n3. **Environment variables** for consistency\n\n## Recommended Tools for gRPC:\n\nâœ… **Evans** (Recommended):\n   - Install: `brew install evans` (macOS) or see https://github.com/ktr0731/evans\n   - Usage: `evans -p 50051 repl`\n\nâœ… **grpcurl** (Command Line):\n   - Install: `go install github.com/fullstorydev/grpcurl/cmd/grpcurl@latest`\n   - Usage: `grpcurl -plaintext localhost:50051 list`\n\nâœ… **gRPCurl GUI**: Web-based gRPC client\n\n## Setup\n1. Import this collection (for reference only)\n2. Use Evans or grpcurl for actual gRPC calls\n3. See POSTMAN_CONFIGURATION.md for detailed setup\n4. See GRPC_SETUP_GUIDE.md for complete guide\n\n## Services Documented:\n- JobExecutionService: Core job management\n- LogStreamService: Real-time log streaming\n- SchedulerService: Job scheduling\n- WorkerAgentService: Worker management\n- AuditService: Audit logs\n- MetricsService: System metrics\n- ProviderManagementService: Provider configuration\n\n## Environment Variables:\n- `grpc_server`: localhost:50051\n- `job_id`: Job ID (auto-generated)\n- `execution_id`: Execution ID (auto-populated)\n- `worker_id`: Worker ID (set as needed)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1. Documentation & Setup",
      "item": [
        {
          "name": "ðŸ“– Setup Guide",
          "request": {
            "description": "See GRPC_SETUP_GUIDE.md for complete setup instructions",
            "method": "GET",
            "url": {
              "raw": "{{grpc_server}}/docs/setup",
              "host": ["{{grpc_server}}"],
              "path": ["docs", "setup"]
            }
          }
        },
        {
          "name": "ðŸ“š API Reference",
          "request": {
            "description": "See docs/GRPC_API_REFERENCE.md for complete API documentation",
            "method": "GET",
            "url": {
              "raw": "{{grpc_server}}/docs/api",
              "host": ["{{grpc_server}}"],
              "path": ["docs", "api"]
            }
          }
        }
      ]
    },
    {
      "name": "2. Job Templates (Copy to gRPC Client)",
      "item": [
        {
          "name": "Queue Job - Simple",
          "request": {
            "description": "Template for simple job queueing. Copy the body and use with: grpcurl -plaintext -d @ localhost:50051 hodei.JobExecutionService/QueueJob",
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{grpc_server}}/template/queue-job",
              "host": ["{{grpc_server}}"],
              "path": ["template", "queue-job"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"job_definition\": {\n    \"name\": \"example-job\",\n    \"command\": \"/bin/bash\",\n    \"arguments\": [\"-lc\", \"echo 'Hello World'\"],\n    \"requirements\": {\n      \"cpu_cores\": 1.0,\n      \"memory_bytes\": 1073741824,\n      \"disk_bytes\": 1073741824\n    },\n    \"timeout\": {\n      \"execution_timeout\": \"300s\"\n    }\n  },\n  \"queued_by\": \"user\"\n}\n\n=== USE WITH grpcurl ===\ngrpcurl -plaintext -d @ localhost:50051 hodei.JobExecutionService/QueueJob\n\n=== USE WITH evans ===\nevans -p 50051 repl\n> package hodei.job\n> service JobExecutionService\n> call QueueJob"
            }
          }
        },
        {
          "name": "Queue Job - Maven Build",
          "request": {
            "description": "Template for Maven build. Copy the body and use with grpcurl or Evans",
            "method": "POST",
            "url": {
              "raw": "{{grpc_server}}/template/maven-build",
              "host": ["{{grpc_server}}"],
              "path": ["template", "maven-build"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"job_definition\": {\n    \"name\": \"maven-build-docker\",\n    \"command\": \"/bin/bash\",\n    \"arguments\": [\"-c\", \"cd /tmp && git clone https://github.com/jenkins-docs/simple-java-maven-app.git && cd simple-java-maven-app && mvn clean package -DskipTests && ls -lh target/\"],\n    \"requirements\": {\n      \"cpu_cores\": 2.0,\n      \"memory_bytes\": 2147483648,\n      \"disk_bytes\": 1073741824\n    },\n    \"metadata\": {\n      \"container_image\": \"maven:3.9.4-eclipse-temurin-17\"\n    },\n    \"timeout\": {\n      \"execution_timeout\": \"600s\"\n    }\n  },\n  \"queued_by\": \"user\"\n}\n\n=== USE WITH grpcurl ===\ngrpcurl -plaintext -d @ localhost:50051 hodei.JobExecutionService/QueueJob\n\n=== USE WITH Evans ===\nevans -p 50051 repl\n> call QueueJob"
            }
          }
        },
        {
          "name": "Get Job Status",
          "request": {
            "description": "Template for getting job details. Replace {{job_id}} with actual ID",
            "method": "POST",
            "url": {
              "raw": "{{grpc_server}}/template/get-job",
              "host": ["{{grpc_server}}"],
              "path": ["template", "get-job"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"job_id\": {\n    \"value\": \"{{job_id}}\"\n  }\n}\n\n=== USE WITH grpcurl ===\ngrpcurl -plaintext -d '{\"job_id\": {\"value\": \"YOUR-JOB-ID\"}}' localhost:50051 hodei.JobExecutionService/GetJob\n\n=== USE WITH Evans ===\n> call GetJob\njobId:\n  value: YOUR-JOB-ID"
            }
          }
        },
        {
          "name": "List Jobs",
          "request": {
            "description": "Template for listing jobs with filters",
            "method": "POST",
            "url": {
              "raw": "{{grpc_server}}/template/list-jobs",
              "host": ["{{grpc_server}}"],
              "path": ["template", "list-jobs"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"limit\": 50\n}\n\n=== VARIATIONS ===\n\nRunning jobs only:\n{\n  \"limit\": 50,\n  \"status\": \"JOB_STATUS_RUNNING\"\n}\n\nSearch by name:\n{\n  \"limit\": 50,\n  \"search_term\": \"maven\"\n}\n\n=== USE WITH grpcurl ===\ngrpcurl -plaintext -d '{\"limit\": 50}' localhost:50051 hodei.JobExecutionService/ListJobs\n\n=== USE WITH Evans ===\n> call ListJobs"
            }
          }
        },
        {
          "name": "Stream Job Logs",
          "request": {
            "description": "Template for streaming logs. Requires gRPC streaming support",
            "method": "POST",
            "url": {
              "raw": "{{grpc_server}}/template/stream-logs",
              "host": ["{{grpc_server}}"],
              "path": ["template", "stream-logs"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"job_id\": \"{{job_id}}\",\n  \"include_history\": true,\n  \"tail_lines\": 50\n}\n\n=== USE WITH grpcurl (streaming) ===\ngrpcurl -plaintext -d '{\"job_id\": \"YOUR-JOB-ID\", \"include_history\": true}' \\\n  localhost:50051 hodei.LogStreamService/SubscribeLogs\n\n=== USE WITH Evans (streaming) ===\n> service LogStreamService\n> call SubscribeLogs\njobId: YOUR-JOB-ID\nincludeHistory: true\n\n=== USE scripts/watch_logs.sh ===\n./scripts/watch_logs.sh YOUR-JOB-ID"
            }
          }
        }
      ]
    },
    {
      "name": "3. Service Reference",
      "item": [
        {
          "name": "JobExecutionService Methods",
          "request": {
            "description": "Available methods in JobExecutionService",
            "method": "GET",
            "url": {
              "raw": "{{grpc_server}}/docs/services/job-execution",
              "host": ["{{grpc_server}}"],
              "path": ["docs", "services", "job-execution"]
            }
          }
        },
        {
          "name": "LogStreamService Methods",
          "request": {
            "description": "Available methods in LogStreamService",
            "method": "GET",
            "url": {
              "raw": "{{grpc_server}}/docs/services/log-stream",
              "host": ["{{grpc_server}}"],
              "path": ["docs", "services", "log-stream"]
            }
          }
        },
        {
          "name": "SchedulerService Methods",
          "request": {
            "description": "Available methods in SchedulerService",
            "method": "GET",
            "url": {
              "raw": "{{grpc_server}}/docs/services/scheduler",
              "host": ["{{grpc_server}}"],
              "path": ["docs", "services", "scheduler"]
            }
          }
        }
      ]
    },
    {
      "name": "4. Quick Commands",
      "item": [
        {
          "name": "List All Services",
          "request": {
            "description": "List all available gRPC services",
            "method": "GET",
            "url": {
              "raw": "grpcurl -plaintext {{grpc_server}} list",
              "host": ["grpcurl", "-plaintext", "{{grpc_server}}", "list"]
            }
          }
        },
        {
          "name": "Check Server Reflection",
          "request": {
            "description": "Check if gRPC reflection is enabled",
            "method": "GET",
            "url": {
              "raw": "grpcurl -plaintext {{grpc_server}} describe hodei.JobExecutionService",
              "host": [
                "grpcurl",
                "-plaintext",
                "{{grpc_server}}",
                "describe",
                "hodei.JobExecutionService"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "5. Troubleshooting",
      "item": [
        {
          "name": "Connection Test",
          "request": {
            "description": "Test if gRPC server is reachable",
            "method": "GET",
            "url": {
              "raw": "nc -zv {{grpc_server}}",
              "host": ["nc", "-zv", "{{grpc_server}}"]
            }
          }
        },
        {
          "name": "Common Errors",
          "request": {
            "description": "See troubleshooting section in documentation",
            "method": "GET",
            "url": {
              "raw": "{{grpc_server}}/docs/troubleshooting",
              "host": ["{{grpc_server}}"],
              "path": ["docs", "troubleshooting"]
            }
          }
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Generate UUID for job_id if not set",
          "if (!pm.environment.get('job_id')) {",
          "    const jobId = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {",
          "        const r = Math.random() * 16 | 0;",
          "        const v = c == 'x' ? r : (r & 0x3 | 0x8);",
          "        return v.toString(16);",
          "    });",
          "    pm.environment.set('job_id', jobId);",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Test response (informational only)",
          "pm.test('This is a template collection - use gRPC tools for actual requests', function () {",
          "    pm.response.to.have.status(200);",
          "});",
          "",
          "// Show instructions for gRPC tools",
          "if (pm.response.code === 200) {",
          "    console.log('Postman Collection for Hodei Jobs Platform');",
          "    console.log('Use Evans or grpcurl for actual gRPC calls');",
          "    console.log('See POSTMAN_CONFIGURATION.md for details');",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "grpc_server",
      "value": "localhost:50051",
      "type": "string"
    },
    {
      "key": "job_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "execution_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "worker_id",
      "value": "",
      "type": "string"
    }
  ]
}
