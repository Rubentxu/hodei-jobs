# Hodei Jobs Platform - Environment Configuration
#
# This file contains all the environment variables used by the Hodei Jobs Platform.
# Copy this file to .env and fill in your values.
#
# Priority: .env file > environment variables
# The server will FAIL FAST if required variables are missing.

# =============================================================================
# REQUIRED VARIABLES
# =============================================================================

# Database Connection
# Format: postgresql://user:password@host:port/database
# Example: postgresql://postgres:postgres@localhost:5432/hodei_jobs
HODEI_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/hodei_jobs

# gRPC Server Configuration
# Address where the gRPC server will listen for connections
# Format: host:port (e.g., 0.0.0.0:9090 for all interfaces, 127.0.0.1:9090 for localhost only)
HODEI_GRPC_BIND=0.0.0.0:9090

# Worker Connection Address
# Address that workers should use to connect to the server
# - In production: Use the Kubernetes service DNS name (e.g., hodei-server.hodei-jobs.svc.cluster.local:9090)
# - In development with telepresence: Use the telepresence intercept DNS name
# - For local development: Use http://localhost:9090
# Format: http://host:port (must include http:// or https:// prefix)
HODEI_WORKER_ADDRESS=http://localhost:9090

# NATS Messaging Configuration
# Connection URLs for NATS server (comma-separated for clustering)
# Format: nats://host:port (e.g., nats://localhost:4222 or nats://nats1:4222,nats2:4222,nats3:4222)
HODEI_NATS_URLS=nats://localhost:4222

# Worker Configuration
# Default Docker image for worker containers
HODEI_WORKER_IMAGE=hodei-jobs-worker:latest

# =============================================================================
# OPTIONAL VARIABLES
# =============================================================================

# Database Pool Configuration
# Maximum number of connections in the pool (default: 50)
#HODEI_DB_POOL_SIZE=50

# Minimum number of idle connections to maintain (default: 10)
#HODEI_DB_MIN_IDLE=10

# Database connection timeout in seconds (default: 30)
#HODEI_DB_CONNECT_TIMEOUT_SECS=30

# Database idle timeout in seconds (default: 600)
#HODEI_DB_IDLE_TIMEOUT_SECS=600

# Database max lifetime in seconds (default: 1800)
#HODEI_DB_MAX_LIFETIME_SECS=1800

# NATS Configuration
# NATS connection timeout in seconds (default: 10)
#HODEI_NATS_TIMEOUT_SECS=10

# Maximum NATS reconnection attempts (default: infinite/None)
#HODEI_NATS_MAX_RECONNECTS=5

# Worker Provisioning Configuration
# OTP token TTL for worker authentication in seconds (default: 300)
#HODEI_WORKER_OTP_TTL_SECS=300

# Maximum workers per provider (default: 10)
#HODEI_MAX_WORKERS_PER_PROVIDER=10

# Enable/disable automatic worker provisioning (default: 1)
#HODEI_PROVISIONING_ENABLED=1

# Logging Configuration
# Log level: trace, debug, info, warn, error (default: info)
#RUST_LOG=info

# Enable log persistence to storage backend (default: 1)
#HODEI_LOG_PERSISTENCE_ENABLED=1

# Log storage backend: local, s3, azure, gcs (default: local)
#HODEI_LOG_STORAGE_BACKEND=local

# Path for local log storage (default: /tmp/hodei-logs)
#HODEI_LOG_PERSISTENCE_PATH=/tmp/hodei-logs

# Log TTL in hours (default: 168 = 7 days)
#HODEI_LOG_TTL_HOURS=168

# Feature Flags
# Development mode (1=on, 0=off) (default: 0)
#HODEI_DEV_MODE=0

# Enable SagaContext V2 migration (default: 0)
#HODEI_SAGA_V2_ENABLED=0

# Percentage of sagas to use V2, 0-100 (default: 0)
#HODEI_SAGA_V2_PERCENTAGE=0

# Configuration File Path
# Optional: Path to .env file (overrides other environment variables)
# If set, the server will load configuration from this file first
#HODEI_CONFIG_FILE=.env

# =============================================================================
# DEPRECATED VARIABLES (will be removed in future versions)
# =============================================================================
# The following variables are deprecated but still supported for backwards compatibility:
# - DATABASE_URL (use HODEI_DATABASE_URL instead)
# - SERVER_DATABASE_URL (use HODEI_DATABASE_URL instead)
# - GRPC_PORT (use HODEI_GRPC_BIND instead, include host in the value)
# - HODEI_SERVER_HOST (use HODEI_GRPC_BIND instead)
# - HODEI_SERVER_ADDRESS (use HODEI_WORKER_ADDRESS instead)
# - HODEI_GRPC_ADDRESS (use HODEI_GRPC_BIND instead)
# - HODEI_WORKER_PORT (included in HODEI_WORKER_ADDRESS instead)
# - HODEI_LOCAL_FALLBACK (removed - no more silent fallbacks)
# - HODEI_DOCKER_ENABLED (removed - providers are auto-discovered)
# - HODEI_KUBERNETES_ENABLED (removed - providers are auto-discovered)
